
#include <immintrin.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>

#define build_dword(b0, b1, b2, b3)     \
     (((uint32_t)((uint8_t)(b0)) << 0*8)    \
    | ((uint32_t)((uint8_t)(b1)) << 1*8)    \
    | ((uint32_t)((uint8_t)(b2)) << 2*8)    \
    | ((uint32_t)((uint8_t)(b3)) << 3*8))

#define _mm512_set4lanes_epi8(b0, b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12, b13, b14, b15) \
    _mm512_setr4_epi32(                  \
        build_dword( b0,  b1,  b2,  b3), \
        build_dword( b4,  b5,  b6,  b7), \
        build_dword( b8,  b9, b10, b11), \
        build_dword(b12, b13, b14, b15))

const __u_char validator[]={11, 194, 212, 250, 170, 59, 207, 241, 119, 21, 61, 59, 225, 168, 68, 86, 69, 71, 47, 193, 68, 18, 37, 242, 131, 253, 199, 248, 255, 27, 23, 138, 22, 239, 177, 60, 30, 38, 210, 213, 36, 54, 158, 109, 121, 33, 96, 218, 171, 202, 48, 26, 249, 73, 41, 229, 239, 188, 145, 166, 91, 96, 21, 125, 238, 212, 120, 14, 169, 101, 227, 117, 79, 37, 87, 37, 52, 72, 240, 57, 149, 188, 209, 192, 245, 69, 8, 92, 171, 232, 20, 64, 206, 79, 4, 96, 146, 34, 124, 171, 228, 33, 184, 251, 158, 115, 69, 215, 114, 224, 93, 107, 58, 213, 237, 210, 235, 151, 239, 139, 85, 21, 210, 139, 205, 88, 35, 229, 76, 71, 181, 29, 189, 101, 232, 105, 66, 80, 0, 110, 125, 212, 82, 67, 60, 34, 152, 166, 100, 6, 84, 56, 17, 105, 41, 57, 170, 155, 253, 56, 125, 107, 187, 90, 190, 204, 128, 181, 235, 63, 228, 202, 25, 88, 250, 244, 67, 149, 224, 153, 243, 60, 153, 176, 41, 246, 139, 23, 216, 8, 164, 239, 145, 206, 232, 188, 133, 63, 70, 172, 140, 252, 156, 36, 19, 86, 19, 209, 191, 5, 177, 164, 189, 86, 36, 243, 38, 77, 43, 173, 249, 53, 93, 149, 96, 178, 236, 192, 224, 150, 54, 14, 170, 177, 218, 124, 25, 209, 0, 160, 210, 177, 166, 93, 24, 25, 55, 116, 251, 146, 61, 117, 185, 101, 170, 135, 207, 210, 49, 5, 130, 225, 175, 223, 114, 106, 224, 37, 207, 3, 126, 28, 18, 32, 211, 233, 196, 227, 102, 27, 44, 96, 103, 119, 53, 188, 48, 247, 60, 183, 208, 69, 31, 152, 110, 28, 141, 53, 223, 42, 203, 123, 7, 111, 151, 74, 26, 165, 168, 41, 56, 93, 235, 249, 105, 108, 38, 248, 49, 213, 106, 61, 106, 211, 206, 78, 27, 246, 165, 110, 103, 248, 191, 175, 146, 46, 95, 237, 69, 176, 110, 166, 12, 102, 38, 54, 83, 139, 223, 219, 95, 166, 164, 207, 44, 216, 208, 220, 118, 104, 34, 50, 213, 241, 191, 0, 158, 146, 178, 137, 86, 202, 124, 102, 143, 178, 63, 239, 136, 163, 63, 232, 159, 237, 138, 237, 204, 91, 110, 122, 169, 213, 125, 166, 91, 123, 139, 54, 241, 182, 39, 194, 201, 245, 251, 69, 245, 222, 50, 108, 178, 183, 128, 190, 19, 76, 184, 85, 235, 133, 244, 112, 219, 102, 246, 87, 238, 220, 224, 53, 121, 86, 176, 124, 223, 165, 114, 18, 154, 63, 172, 49, 192, 99, 65, 90, 86, 155, 219, 124, 111, 220, 96, 220, 80, 54, 84, 202, 112, 68, 88, 158, 42, 1, 148, 174, 155, 49, 86, 185, 122, 108, 153, 94, 228, 67, 112, 247, 165, 2, 46, 210, 118, 78, 163, 152, 12, 101, 86, 61, 211, 89, 204, 232, 214, 110, 70, 26, 69, 72, 183, 33, 93, 199, 147, 21, 40, 59, 140, 69, 202, 249, 146, 219, 79, 156, 119, 2, 44, 57, 20, 196, 207, 125, 248, 201, 214, 24, 176, 110, 196, 182, 223, 230, 38, 255, 161, 143, 21, 69, 64, 16, 39, 246, 196, 169, 187, 152, 82, 127, 49, 249, 202, 213, 124, 78, 83, 134, 98, 149, 17, 29, 239, 236, 66, 236, 135, 183, 94, 119, 34, 99, 164, 160, 45, 164, 119, 45, 78, 70, 129, 191, 35, 187, 217, 17, 172, 19, 36, 100, 1, 192, 95, 149, 208, 216, 241, 143, 91, 52, 132, 225, 87, 93, 188, 163, 122, 164, 18, 51, 93, 168, 210, 252, 35, 232, 85, 137, 86, 81, 84, 79, 160, 95, 64, 48, 242, 196, 177, 149, 30, 70, 41, 8, 94, 171, 90, 82, 23, 32, 202, 153, 198, 155, 9, 162, 9, 63, 184, 241, 226, 81, 111, 12, 90, 214, 24, 164, 76, 67, 242, 1, 28, 30, 250, 12, 40, 33, 14, 96, 237, 197, 111, 92, 175, 37, 0, 170, 125, 49, 132, 40, 53, 174, 249, 252, 146, 78, 43, 126, 227, 82, 7, 175, 161, 110, 15, 201, 47, 12, 216, 162, 163, 15, 146, 73, 40, 9, 226, 51, 204, 185, 238, 35, 123, 140, 233, 33, 148, 13, 8, 208, 114, 62, 20, 80, 223, 18, 34, 177, 42, 53, 117, 119, 240, 26, 74, 54, 249, 71, 49, 227, 155, 82, 243, 221, 117, 254, 6, 112, 240, 25, 2, 118, 18, 54, 60, 245, 85, 238, 136, 183, 4, 13, 198, 1, 183, 136, 173, 146, 208, 201, 155, 99, 140, 70, 41, 114, 228, 104, 247, 0, 40, 78, 203, 58, 230, 131, 32, 107, 57, 240, 198, 103, 249, 66, 212, 144, 118, 160, 70, 222, 134, 174, 72, 163, 118, 23, 239, 85, 46, 38, 46, 114, 236, 189, 152, 148, 33, 68, 7, 178, 159, 98, 172, 242, 1, 240, 157, 124, 226, 50, 231, 216, 199, 110, 73, 73, 217, 196, 50, 217, 142, 17, 131, 21, 178, 71, 213, 101, 224, 86, 224, 245, 202, 151, 108, 114, 30, 93, 148, 229, 74, 29, 159, 57, 210, 185, 148, 24, 193, 251, 42, 183, 46, 222, 171, 189, 167, 134, 107, 231, 130, 27, 100, 8, 59, 37, 77, 139, 192, 88, 136, 195, 133, 40, 240, 28, 249, 8, 95, 14, 168, 58, 185, 238, 176, 30, 219, 212, 27, 87, 170, 158, 244, 37, 143, 4, 44, 188, 94, 61, 112, 201, 180, 254, 46, 189, 33, 201, 132, 235, 207, 133, 237, 4, 67, 232, 145, 28, 159, 143, 33, 82, 146, 168, 213, 205, 26, 5, 142, 179, 54, 4, 84, 17, 8, 140, 126, 126, 132, 67, 235, 146, 201, 135, 154, 232, 84, 39, 156, 12, 99, 237, 2, 104, 47, 160, 105, 34, 38, 235, 103, 68, 187, 99, 142, 77, 139, 65, 205, 165, 185, 86, 107, 120, 112, 243, 229, 210, 28, 44, 76, 112, 202, 115, 101, 106, 180, 230, 179, 216, 218, 104, 238, 217, 41, 128, 1, 126, 210, 139, 120, 163, 3, 22, 137, 2, 53, 23, 151, 246, 245, 38, 84, 218, 237, 166, 78, 106, 137, 89, 96, 232, 240, 208, 54, 10, 206, 42, 71, 164, 130, 129, 244, 16, 8, 86, 93, 21, 232, 233, 8, 9, 198, 19, 171, 119, 123, 104, 192, 227, 15, 81, 192, 194, 216, 136, 210, 191, 188, 31, 224, 155, 167, 96, 40, 213, 187, 28, 142, 109, 243, 29, 156, 133, 111, 169, 252, 195, 202, 131, 108, 190, 124, 5, 203, 216, 62, 91, 48, 239, 31, 17, 204, 90, 94, 226, 20, 129, 72, 128, 172, 19, 112, 5, 8, 243, 25, 109, 143, 20, 243, 150, 211, 204, 10, 70, 149, 195, 251, 110, 180, 142, 121, 43, 114, 42, 61, 161, 126, 71, 172, 22, 79, 195, 220, 130, 179, 141, 234, 99, 199, 225, 185, 106, 30, 97, 88, 59, 82, 84, 144, 198, 120, 22, 136, 98, 114, 28, 102, 202, 65, 91, 76, 186, 252, 98, 146, 216, 62, 80, 82, 122, 87, 134, 184, 144, 169, 25, 125, 236, 91, 43, 71, 243, 107, 64, 177, 101, 162, 94, 132, 119, 43, 168, 129, 203, 69, 167, 118, 105, 254, 110, 61, 19, 122, 95, 203, 19, 35, 190, 221, 222, 126, 35, 102, 238, 243, 194, 182, 115, 224, 114, 35, 128, 96, 85, 200, 158, 11, 46, 4, 213, 158, 173, 168, 224, 151, 45, 229, 73, 87, 13, 188, 139, 21, 113, 14, 121, 124, 172, 69, 240, 134, 218, 175, 232, 108, 213, 67, 102, 12, 68, 123, 233, 171, 40, 79, 145, 50, 250, 213, 61, 30, 168, 2, 59, 50, 83, 103, 40, 185, 26, 169, 225, 161, 82, 210, 1, 70, 126, 72, 208, 7, 20, 113, 135, 244, 215, 23, 165, 53, 3, 231, 10, 34, 3, 12, 188, 242, 59, 84, 56, 114, 200, 218, 173, 254, 217, 59, 169, 121, 146, 204, 20, 130, 129, 14, 220, 79, 37, 126, 141, 181, 194, 136, 214, 178, 223, 82, 236, 110, 3, 60, 168, 128, 219, 250, 207, 78, 114, 126, 94, 71, 196, 157, 60, 210, 102, 100, 49, 52, 13, 253, 170, 234, 147, 94, 9, 184, 58, 147, 175, 64, 128, 170, 218, 118, 252, 108, 52, 190, 143, 127, 41, 241, 70, 31, 111, 39, 175, 236, 209, 214, 88, 16, 228, 108, 223, 10, 50, 72, 205, 141, 191, 107, 74, 109, 214, 225, 59, 50, 26, 86, 8, 107, 146, 189, 185, 230, 216, 165, 0, 228, 164, 104, 167, 162, 40, 54, 56, 202, 134, 17, 220, 245, 213, 211, 42, 22, 130, 30, 40, 250, 210, 20, 209, 200, 56, 174, 109, 178, 37, 69, 234, 212, 181, 240, 195, 36, 146, 220, 198, 43, 132, 230, 244, 177, 189, 178, 169, 179, 253, 4, 146, 210, 78, 209, 13, 127, 130, 110, 15, 218, 2, 65, 184, 122, 30, 126, 64, 241, 60, 145, 1, 241, 130, 97, 62, 33, 150, 94, 101, 153, 47, 168, 54, 230, 72, 182, 185, 34, 183, 30, 200, 118, 49, 172, 88, 66, 122, 20, 61, 18, 205, 72, 112, 186, 63, 94, 62, 73, 79, 125, 85, 117, 136, 79, 91, 146, 149, 170, 190, 226, 90, 212, 112, 89, 196, 193, 176, 69, 95, 214, 131, 62, 151, 232, 16, 153, 67, 69, 149, 149, 50, 123, 168, 240, 96, 121, 91, 64, 210, 44, 182, 134, 22, 12, 200, 201, 135, 22, 68, 193, 17, 20, 1, 131, 122, 108, 5, 186, 225, 10, 3, 41, 30, 29, 33, 165, 48, 126, 255, 21, 193, 37, 149, 247, 4, 85, 179, 180, 112, 192, 58, 41, 11, 169, 235, 167, 118, 28, 230, 251, 76, 249, 56, 108, 144, 238, 32, 104, 10, 173, 188, 48, 172, 49, 213, 221, 81, 196, 110, 107, 50, 167, 46, 231, 48, 93, 243, 190, 67, 154, 69, 11, 236, 46, 101, 233, 103, 171, 224, 57, 19, 199, 138, 173, 43, 84, 63, 67, 81, 238, 228, 122, 125, 249, 22, 131, 66, 138, 175, 63, 177, 138, 223, 89, 7, 17, 240, 177, 213, 46, 18, 112, 112, 235, 10, 154, 111, 79, 201, 206, 33, 208, 233, 252, 137, 128, 109, 247, 102, 176, 145, 31, 103, 53, 138, 107, 89, 252, 183, 94, 159, 82, 249, 45, 127, 146, 3, 36, 33, 245, 177, 83, 110, 39, 163, 128, 226, 243, 210, 37, 93, 233, 139, 171, 238, 30, 221, 24, 27, 164, 184, 149, 113, 8, 204, 55, 143, 26, 44, 20, 111, 124, 17, 250, 36, 179, 254, 80, 103, 68, 253, 251, 212, 231, 63, 17, 124, 91, 70, 153, 146, 66, 151, 176, 55, 41, 0, 34, 171, 140, 53, 85, 221, 101, 111, 88, 105, 27, 147, 30, 64, 67, 67, 65, 145, 229, 91, 75, 132, 10, 67, 55, 85, 88, 67, 146, 104, 187, 232, 37, 46, 132, 218, 162, 242, 145, 230, 83, 185, 38, 6, 147, 157, 108, 122, 29, 179, 24, 40, 118, 180, 80, 160, 93, 143, 10, 4, 159, 244, 99, 129, 84, 122, 161, 35, 141, 136, 70, 108, 216, 62, 11, 63, 192, 123, 112, 79, 126, 160, 251, 255, 39, 124, 237, 116, 244, 142, 67, 185, 204, 238, 176, 60, 236, 191, 30, 1, 249, 58, 186, 214, 212, 209, 255, 218, 169, 192, 191, 127, 164, 34, 15, 16, 106, 90, 73, 202, 115, 120, 93, 251, 34, 80, 33, 255, 138, 81, 106, 142, 132, 255, 3, 36, 245, 72, 26, 232, 225, 51, 214, 208, 104, 156, 91, 39, 155, 216, 77, 65, 108, 252, 190, 113, 96, 26, 98, 108, 170, 24, 75, 142, 112, 68, 28, 24, 196, 99, 3, 179, 201, 243, 104, 213, 104, 204, 161, 23, 83, 210, 10, 2, 145, 192, 207, 183, 227, 106, 182, 50, 86, 60, 117, 207, 45, 73, 84, 224, 204, 20, 233, 143, 57, 196, 115, 47, 72, 165, 42, 65, 93, 43, 148, 152, 108, 152, 51, 239, 167, 44, 216, 136, 119, 92, 20, 198, 166, 10, 181, 7, 143, 245, 198, 146, 101, 133, 209, 211, 111, 191, 153, 182, 154, 173, 232, 133, 128, 109, 149, 155, 112, 214, 148, 98, 81, 147, 101, 200, 40, 101, 249, 156, 9, 69, 69, 176, 96, 206, 31, 80, 3, 200, 109, 219, 70, 70, 208, 68, 136, 205, 42, 245, 166, 109, 108, 171, 252, 249, 245, 18, 236, 208, 211, 93, 25, 103, 102, 204, 228, 26, 164, 50, 188, 183, 90, 118, 13, 148, 94, 254, 40, 116, 188, 222, 236, 153, 59, 82, 151, 42, 208, 182, 76, 191, 170, 53, 31, 3, 33, 96, 2, 155, 108, 206, 137, 12, 208, 88, 229, 99, 89, 142, 110, 245, 95, 12, 252, 24, 24, 62, 152, 233, 24, 234, 210, 161, 86, 140, 111, 114, 139, 70, 126, 213, 239, 112, 215, 17, 233, 89, 204, 254, 166, 125, 47, 176, 79, 199, 239, 150, 159, 140, 48, 63, 17, 157, 5, 169, 61, 242, 79, 2, 158, 51, 225, 157, 189, 107, 210, 122, 171, 165, 248, 119, 172, 5, 107, 170, 6, 75, 27, 207, 237, 11, 158, 246, 208, 24, 227, 186, 8, 210, 214, 243, 38, 96, 156, 129, 148, 39, 149, 146, 86, 208, 67, 118, 145, 0, 67, 223, 43, 39, 14, 110, 163, 82, 155, 43, 69, 141, 169, 220, 37, 94, 81, 192, 44, 56, 101, 113, 220, 124, 159, 69, 153, 23, 18, 112, 97, 170, 144, 2, 51, 131, 213, 109, 117, 187, 37, 124, 213, 16, 48, 120, 2, 66, 141, 120, 43, 96, 107, 96, 51, 131, 196, 240, 135, 229, 7, 243, 224, 181, 220, 39, 130, 81, 154, 150, 101, 152, 133, 185, 21, 56, 6, 176, 34, 247, 125, 146, 60, 203, 164, 172, 54, 223, 231, 40, 28, 19, 112, 108, 38, 135, 204, 138, 239, 187, 72, 12, 254, 119, 200, 237, 178, 24, 203, 166, 196, 203, 238, 94, 115, 113, 187, 4, 17, 209, 35, 117, 14, 242, 247, 120, 135, 42, 103, 212, 92, 229, 229, 212, 217, 10, 122, 232, 68, 125, 225, 193, 172, 32, 166, 5, 222, 112, 5, 174, 60, 52, 107, 55, 122, 67, 147, 106, 1, 21, 133, 66, 208, 16, 127, 116, 38, 77, 255, 221, 2, 169, 125, 240, 229, 108, 125, 157, 151, 97, 174, 147, 156, 14, 188, 115, 169, 27, 174, 229, 188, 234, 57, 88, 131, 206, 174, 195, 82, 178, 196, 184, 5, 223, 242, 225, 36, 97, 209, 80, 251, 190, 38, 250, 177, 209, 212, 145, 184, 180, 116, 208, 183, 10, 196, 114, 228, 101, 140, 178, 88, 127, 22, 170, 174, 154, 124, 223, 20, 208, 53, 107, 42, 211, 82, 254, 12, 163, 66, 171, 179, 173, 14, 151, 128, 174, 164, 14, 120, 61, 72, 237, 76, 141, 230, 161, 41, 15, 126, 107, 174, 16, 155, 229, 124, 70, 2, 220, 107, 166, 153, 77, 17, 187, 184, 62, 183, 125, 208, 109, 141, 81, 103, 148, 67, 78, 252, 79, 221, 59, 213, 133, 208, 131, 55, 153, 85, 162, 210, 102, 14, 82, 248, 228, 218, 135, 2, 46, 50, 129, 161, 53, 12, 59, 66, 244, 211, 147, 115, 100, 38, 242, 34, 193, 90, 234, 80, 64, 166, 46};
const unsigned char magic_3[] = {168,4,134,94,202,222,242,76,243,18,85,229,127,154,107,80,181,52,218,155,80,101,66,217,120,90,100,177,98,145,140,139,104,252,216,251,253,17,212,172,73,48,183,247,213,165,123,107,85,122,218,97,100,236,35,149,56,110,28,215,171,125,205,57,61,129,211,42,201,19,97,198,209,117,48,127,170,24,166,189,153,36,144,14,33,64,181,208,204,231,119,172,196,8,205,17,227,149,88,26,104,121,235,109,184,6,103,46,173,145,59,4,233,170,185,111,29,197,18,251,161,130,255,23,40,47,184,198,184,194,191,23,206,163,121,15,136,90,74,178,82,227,47,242,178,181,108,212,198,19,186,82,64,155,55,247,181,245,30,174,43,218,76,243,41,50,236,187,139,25,251,128,151,57,40,4,75,175,63,154,32,235,158,126,147,44,29,79,45,73,158,124,241,140,160,34,243,155,225,185,217,112,181,41,201,189,244,74,224,31,107,175,2,213,32,148,227,242,149,253,4,76,207,211,6,217,48,86,111,178,173,252,79,76,107,85,241,100,116,92,165,245,220,46,95,155,50,208,12,92,30,188,116,32,240,11,109,202,48,56,102,174,246,219,159,104,238,212,132,132,6,221,143,207,36,128,130,13,53,85,197,34,206,155,159,212,185,64,68,144,142,190,101,170,225,60,65,62,242,74,76,214,253,197,179,130,111,244,30,230,185,100,131,128,87,59,234,133,63,44,107,251,42,243,119,224,187,224,90,180,235,132,118,24,63,104,101,17,93,86,211,148,153,186,71,101,118,206,190,167,5,226,23,208,42,151,113,11,72,45,254,225,38,54,66,119,137,249,72,246,17,15,114,133,194,143,199,42,227,119,247,70,69,88,201,53,2,101,203,40,88,37,53,242,99,118,188,222,107,139,2,240,121,153,89,161,27,74,134,114,26,138,151,91,132,27,169,24,101,153,108,229,137,93,191,227,93,9,227,214,74,12,149,244,224,134,87,180,172,250,242,176,60,196,221,249,56,196,86,73,158,4,175,119,34,45,200,228,242,170,229,201,159,194,222,141,17,196,53,147,245,206,206,60,178,159,69,120,202,71,81,90,42,120,53,251,58,4,60,37,46,164,214,117,166,88,236,11,7,128,232,210,186,181,81,232,7,77,46,119,120,99,112,83,103,24,61,237,111,4,164,215,36,246,92,132,160,175,146,239,60,65,145,178,120,67,60,68,223,11,229,97,105,188,72,170,166,116,254,193,131,108,26,112,234,75,77,228,27,242,52,26,212,52,81,155,175,165,219,212,150,218,35,139,38,254,107,228,126,189,182,3,241,244,247,3,72,64,233,194,103,126,133,41,115,254,77,58,184,109,148,237,67,66,82,114,48,249,76,66,25,107,103,199,92,165,144,108,43,221,182,117,231,23,222,223,57,217,49,198,204,44,31,21,183,161,236,61,172,17,185,82,160,155,212,169,103,45,84,167,59,132,15,125,78,151,95,22,150,32,233,153,22,199,13,156,214,9,191,21,252,235,156,159,212,200,231,198,20,66,32,1,166,146,162,247,138,246,25,255,110,89,121,241,236,43,220,38,125,14,23,178,173,117,60,237,212,63,228,219,252,100,71,52,231,117,92,48,77,222,15,155,111,41,212,43,218,86,110,175,42,105,159,2,54,146,190,130,175,52,155,247,59,17,159,123,231,85,161,209,15,47,74,187,210,177,210,31,150,124,245,227,247,254,214,60,78,172,25,245,8,209,146,233,87,77,253,124,115,120,211,5,86,26,227,71,34,163,88,53,170,198,212,98,165,45,17,212,108,152,200,166,136,156,234,49,64,125,219,103,76,38,140,14,156,63,185,39,197,75,231,95,140,186,47,170,21,83,212,4,98,186,20,96,1,45,245,152,41,46,255,207,112,171,235,158,109,109,146,114,46,227,121,250,55,101,240,14,40,235,40,160,52,228,212,247,28,240,169,203,9,205,23,173,75,126,240,22,76,23,148,114,126,53,247,190,68,254,78,243,217,87,103,133,149,118,134,10,172,90,59,217,109,70,146,212,81,4,13,5,44,149,185,122,88,55,156,140,38,239,20,153,78,55,188,109,127,104,27,106,161,90,233,112,92,87,61,79,186,165,104,59,147,32,103,246,36,104,38,242,40,213,164,85,203,237,48,6,11,0,102,34,39,141,36,188,30,97,8,119,95,62,76,38,144,161,37,190,131,195,89,209,79,250,95,127,21,131,236,14,252,125,114,138,228,45,79,227,131,180,145,203,169,129,72,121,6,138,100,201,144,179,164,50,45,31,218,125,124,101,13,230,177,221,225,125,63,233,30,251,157,81,77,242,85,11,255,70,152,29,9,38,68,63,238,111,246,95,194,74,44,6,232,180,235,164,190,92,76,182,184,5,97,246,209,141,150,2,108,22,251,58,199,196,3,247,223,145,114,102,186,188,231,234,150,19,216,220,252,143,245,49,13,48,143,100,79,51,52,205,133,29,89,216,91,78,240,149,39,220,182,97,191,141,85,190,15,255,150,172,15,120,164,116,178,81,109,237,78,118,25,211,22,89,82,165,160,233,82,66,68,76,40,95,11,87,231,202,8,238,162,174,204,251,62,181,108,58,199,194,33,27,26,174,139,222,1,237,32,114,63,249,90,248,6,122,184,125,5,104,49,63,236,130,130,75,178,110,226,142,116,60,186,163,19,245,125,64,81,4,142,113,153,122,204,115,143,59,53,34,185,206,56,97,18,72,122,197,246,116,245,77,246,4,178,217,125,65,239,237,238,11,187,242,147,157,230,50,204,35,253,175,226,86,73,237,244,10,49,76,204,244,22,228,176,4,4,175,121,232,161,51,254,50,208,110,177,194,177,203,171,108,23,31,77,59,170,188,20,111,141,51,30,75,249,162,40,185,223,18,187,58,176,106,127,138,234,166,69,224,21,209,183,127,129,161,17,124,138,72,255,87,148,0,181,82,17,197,223,38,52,185,151,192,251,63,111,126,133,14,253,107,79,243,90,78,222,119,166,43,120,176,119,174,78,82,137,202,8,160,189,115,43,31,126,128,233,110,209,69,26,125,46,81,113,63,6,176,158,210,182,255,6,140,169,196,84,65,232,113,237,89,82,37,221,50,236,137,124,108,255,191,136,49,72,103,67,8,194,228,11,249,122,163,116,241,25,127,185,230,223,92,60,205,206,181,254,11,0,36,72,221,227,131,164,153,139,137,39,168,250,205,123,105,141,192,251,203,156,123,209,162,74,103,82,190,92,13,102,61,223,112,25,56,71,97,6,49,210,55,241,13,0,75,133,99,150,100,133,203,173,129,243,15,176,116,142,169,235,56,129,141,254,230,158,69,250,234,168,100,45,179,184,138,215,140,183,108,15,101,43,101,202,37,171,5,124,213,150,96,105,139,254,204,221,116,152,59,145,69,219,112,62,106,62,132,151,160,41,11,66,67,175,156,201,251,109,248,183,91,210,6,168,98,240,228,36,20,125,98,74,242,239,88,155,125,135,136,149,134,96,239,46,20,123,1,213,18,94,27,179,29,35,96,31,130,243,230,185,39,150,241,3,253,75,175,21,104,126,204,125,165,116,249,221,20,143,114,196,128,133,221,129,61,110,238,19,236,86,134,138,46,116,9,57,158,117,112,240,155,203,224,160,70,111,150,38,2,120,120,184,250,46,169,156,230,203,134,26,204,127,197,229,23,35,87,250,190,127,243,106,57,132,44,32,3,125,38,120,196,216,18,79,156,10,249,216,185,122,194,180,221,27,111,107,66,104,104,63,197,97,0,186,91,226,249,10,113,69,195,161,247,64,90,54,209,141,83,244,60,183,141,239,167,182,44,56,88,96,219,46,168,2,214,121,184,175,92,142,113,15,73,16,253,219,79,11,33,203,170,80,106,148,36,110,145,96,186,154,188,17,25,248,214,16,157,3,126,134,76,117,22,87,246,153,124,143,229,8,99,5,158,201,105,36,206,123,181,205,111,193,86,214,68,6,15,69,39,60,198,29,244,186,82,190,55,209,69,11,77,154,46,208,32,215,101,75,103,248,9,73,77,55,238,110,89,81,238,1,64,205,117,31,95,36,43,124,91,12,165,25,35,195,218,222,123,77,95,140,165,251,248,228,198,229,173,3,104,59,34,64,102,143,157,109,7,65,31,123,174,27,122,198,53,200,1,209,166,24,98,63,177,182,237,32,227,163,179,94,24,239,76,18,217,213,200,205,54,52,17,2,60,243,221,107,86,91,220,238,45,178,210,202,63,249,248,161,193,78,63,97,169,83,162,102,63,212,28,199,213,255,38,109,219,28,10,11,9,224,91,183,182,205,8,135,117,220,197,124,194,130,174,54,30,9,17,127,81,108,126,81,118,21,203,37,87,238,38,12,113,146,226,101,254,221,87,71,164,123,186,250,245,223,253,155,33,91,123,125,63,4,78,215,150,216,235,101,104,76,133,143,90,221,76,250,85,149,110,85,101,79,194,7,56,167,146,208,21,202,254,94,153,141,133,196,13,210,20,199,216,167,160,57,132,179,120,203,120,236,70,78,45,63,154,125,62,58,243,46,252,74,2,215,20,127,154,43,125,59,47,73,32,90,119,53,223,89,236,3,191,109,239,10,86,48,3,31,150,145,63,254,143,127,8,37,9,242,139,117,85,189,109,198,209,209,170,250,237,104,98,143,124,168,20,24,220,113,132,128,81,194,24,26,225,239,166,242,115,101,44,17,128,144,48,202,210,129,53,236,199,226,170,142,105,194,69,216,46,212,110,234,136,108,95,154,203,30,243,240,174,131,120,217,69,25,223,185,36,66,55,194,80,135,134,101,119,20,228,239,206,173,212,49,159,255,56,212,56,235,12,209,53,250,218,219,184,126,204,145,18,214,253,135,44,35,124,17,39,232,210,43,243,251,219,87,31,231,102,168,1,61,120,47,107,173,78,170,97,82,215,232,226,72,210,204,217,212,186,86,215,70,41,50,125,119,81,103,32,183,115,51,255,184,135,217,133,83,219,29,105,107,180,226,165,158,200,197,191,46,183,132,23,17,205,116,37,95,202,47,72,11,175,9,254,102,129,33,100,69,98,79,212,0,45,113,77,16,183,47,28,78,208,198,45,11,86,146,246,85,163,183,130,14,126,12,83,14,220,33,254,233,102,232,63,209,56,82,90,177,226,116,111,170,234,139,117,255,90,161,200,121,0,95,53,214,185,165,150,28,110,97,34,223,240,242,154,39,235,193,71,238,146,195,201,37,156,69,133,169,162,165,55,131,177,77,115,145,229,254,245,108,150,183,64,199,130,63,45,196,216,158,119,175,155,249,60,26,44,36,111,75,17,52,33,120,152,223,209,25,79,183,161,146,131,239,79,211,2,232,200,225,110,249,199,242,171,142,166,130,14,242,18,118,102,118,127,68,115,208,51,109,47,85,230,24,0,177,216,136,123,75,202,180,113,237,145,130,128,161,138,215,245,91,214,189,107,238,121,42,69,88,120,9,153,73,132,7,45,62,253,92,73,210,204,134,123,34,134,92,249,173,249,240,131,242,236,85,231,48,110,184,215,132,93,204,216,138,75,6,92,87,146,131,168,43,103,185,30,135,20,74,18,118,248,154,122,253,252,81,33,246,232,175,220,228,4,140,213,75,166,196,64,129,43,115,219,13,237,91,213,33,6,196,121,81,101,116,95,115,130,215,109,119,142,178,170,189,85,211,220,130,99,108,126,58,149,149,80,109,149,7,192,88,31,26,208,20,138,203,18,237,202,69,120,78,121,86,221,17,43,211,234,248,6,137,205,40,239,85,112,138,82,4,193,255,37,119,225,142,107,223,33,67,171,163,136,70,148,252,12,119,114,70,6,99,171,197,193,206,203,110,176,16,240,156,84,205,145,102,23,213,104,137,17,150,195,157,207,101,176,181,243,3,241,74,196,198,20,251,128,40,0,103,99,73,15,94,31,239,94,55,242,177,137,207,146,129,198,91,63,122,24,26,108,230,174,31,33,34,11,192,241,214,211,39,1,31,205,163,160,193,86,192,97,7,77,216,154,209,24,223,78,80,117,202,48,156,49,91,92,185,157,8,57,137,138,9,171,82,244,44,83,246,72,68,210,133,47,56,121,251,4,120,252,15,178,128,209,8,71,136,30,24,230,121,140,141,114,255,190,58,55,159,105,156,159,46,138,141,150,139,65,111,148,71,8,161,88,114,0,193,210,197,236,213,171,206,205,167,233,163,236,150,45,37,209,254,194,153,170,30,123,175,78,104,51,212,191,94,86,65,139,41,17,242,210,205,116,255,181,128,24,92,162,221,131,197,139,0,214,74,186,236,30,57,16,77,244,69,107,23,9,67,131,179,201,107,129,76,174,227,2,228,205,159,2,116,167,7,86,9,128,12,92,221,113,127,105,15,154,98,14,68,155,184,139,82,117,240,32,124,139,18,62,65,139,250,5,188,178,3,181,251,214,251,96,215,129,107,168,61,110,67,130,150,43,218,127,217,46,24,44,235,215,88,88,182,140,12,245,50,111,236,6,193,111,62,125,162,81,65,163,35,127,87,41,86,19,30,125,15,51,6,254,136,97,255,26,199,136,105,49,89,197,246,63,250,53,57,148,222,110,250,77,67,60,216,146,225,247,103,8,124,246,85,35,63,54,126,14,36,101,151,56,248,174,49,182,124,148,138,90,175,93,139,66,130,216,250,238,248,198,2,98,21,18,8,43,183,157,177,253,3,208,45,92,38,198,149,50,204,6,29,122,88,187,9,119,49,199,213,50,205,125,100,115,91,15,255,109,21,11,68,245,79,186,215,52,173,65,219,58,96,210,127,210,179,2,21,255,32,216,219,197,119,227,183,148,57,179,158,17,152,110,87,162,85,156,119,171,235,107,243,123,214,121,167,195,156,127,26,162,156,62,88,164,103,166,64,145,220,225,147,170,138,23,50,123,152,123,3,130,56,47,253,198,175,124,38,51,109,167,110,25,170,25,15,173,187,32,31,194,238,219,164,26,35,107,207,54,184,121,193,114,52,133,25,139,33,137,49,171,137,83,141,135,159,99,187,121,237,234,11,230,193,204,161,86,88,139,14,115,250,94,22,129,83,225,57,111,89,56,95,219,51,62,234,187,90,156,41,213,176,242,95,77,28,156,74,203,241,29,118,82,65,98,23,2,184,173,34,209,91,177,206,99,61,169,189,103,166,75,195,4,54,204,45,21,209,185,216,29,35,230,56,130,170,104,238,215,141,175,250,212,106,67,178,194,238,34,35,109,89,56,15,69,229,127,63,27,30,11,214,129,18,221,139,52,5,209,123,54,82,169,11,147,143,62,94,166,55,240,10,133,53,19,35,151,15,189,9,4,244,185,41,34,137,164,200,185,241,246,107,135,72,219,2,107,167,73,62,207,50,89,161,26,46,185,242,46,167,83,132,30,174,214,5,207,71,61,175,215,211,201,159,192,202,243,24,194,6,114,12,209,169,223,146,194,134,112,207,247,40,155,50,88,82,217,62,60,124,102,139,6,64,16,39,85,74,73,207,27,124,101,80,24,225,149,40,1,162,216,127,231,173,51,2,203,201,217,143,6,120,62,60,66,125,170,109,34,200,141,110,155,129,170,4,74,87,83,144,181,251,176,194,166,75,6,162,203,19,61,27,169,149,86,87,205,91,114,230,169,77,193,186,81,139,217,45,49,103,181,170,161,151,125,245,82,144,40,65,9,219,93,15,194,92,114,87,37,183,61,90,116,57,89,29,36,16,76,246,207,88,248,30,37};
const uint32_t magic_1[] = {0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140};
const uint32_t magic_2[] = {0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000};
const unsigned char values[]={0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,62,0x80,0x80,0x80,63,52,53,54,55,56,57,58,59,60,61,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0x80,0x80,0x80,0x80,0x80,0x80,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,0x80,0x80,0x80,0x80,0x80};
__m512i lookup_0;
__m512i lookup_1;

__m512i xor[54];

void f1(__m128i *m1, __m128i *m2, __m128i *res){
    __m128i r, c, x;
    __m128i ret[4];

    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 0);
    
    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 1);
    
    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 2);
    
    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 3);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 0);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 1);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 2);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);

    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 3);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 0);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 1);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 2);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 3);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 0);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 1);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 2);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);

    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 3);
    res[0] = ret[0];
    res[1] = ret[1];
    res[2] = ret[2];
    res[3] = ret[3];
}

void f0(__m128i *mat, uint32_t exp, __m128i *res){
    int exp_i = 31;
    uint32_t _ret[16] = {1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1};
    __m128i ret[4] = {_mm_load_epi32(_ret+0x0), _mm_load_epi32(_ret+0x4), _mm_load_epi32(_ret+0x8), _mm_load_epi32(_ret+0xc)};

    while(exp_i >= 0){
        if(exp & (1 << exp_i)){
            f1(ret, ret, ret);
            f1(ret, mat, ret);
        }
        else{
            f1(ret, ret, ret);
        }
        exp_i--;
    }
    for(int i=0; i<4; i++){
        res[i] = ret[i];
    }
}

void setup(){
    lookup_0 = _mm512_loadu_epi8(values);
    lookup_1 = _mm512_loadu_epi8(values+64);
    for(int i=0; i<54; i++){
        xor[i]=_mm512_load_si512(magic_3+i*64);
    }
}

__m512i lookup(const __m512i input) {

    const __m512i translated = _mm512_permutex2var_epi8(lookup_0, input, lookup_1);

    const uint64_t mask = _mm512_movepi8_mask(translated | input); // convert MSBs to the mask
    if (mask) {
        puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
        exit(-1);
    }

    return translated;
}

int main(){
    setup();
    char input[512]={0};
    printf("Please input your product key: ");
    fgets(input, 512, stdin);
    if(input[strlen(input)-1]=='\n'){
        input[strlen(input)-1]='\0';
    }
    if(strncmp(input, "ptm{", 4)!=0 || input[strlen(input)-1]!='}' || (strlen(input)-5)%2!=0 || (int)((strlen(input)-5)/2)%3!=0){
        puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
        exit(-1);
    }

    size_t size = (int)((strlen(input)-5)/2);
    __m512i *rows = malloc(sizeof(__m512i)*size);

    uint32_t data[4] = {3082479570,  404556667, 2593462557, 1619391743};
    uint32_t data2[4] = {3896563185,  551914195, 3138858061, 1932880005};
    uint32_t data3[4] = {3152929916, 2405058092,  231066320,  887409827};
    uint32_t data4[4] = {2950501807,  580593730,  420528199, 2240878451};
    __m128i matrix[4] = {_mm_load_epi32(data), _mm_load_epi32(data2), _mm_load_epi32(data3), _mm_load_epi32(data4)};

    for(int counter=4; counter<(strlen(input)-1); counter+=2){ //FastExp step
        uint32_t exponent = input[counter+1];
        exponent = (exponent<<8)+input[counter];
        __m128i output[4];
        f0(matrix, exponent, output);
        __m512i output512 = _mm512_castsi128_si512(output[0]);
        output512 = _mm512_inserti32x4(output512, output[1], 1);
        output512 = _mm512_inserti32x4(output512, output[2], 2);
        output512 = _mm512_inserti32x4(output512, output[3], 3);
        rows[(int)((counter-4)/2)]=output512;
    }

    for(int i=0; i<size;i+=3){ //Ternary logic step
        __m512i tmp1, tmp2, tmp3;
        tmp1 = _mm512_ternarylogic_epi32(rows[i], rows[i+1], rows[i+2], 106);
        tmp2 = _mm512_ternarylogic_epi32(rows[i], rows[i+1], rows[i+2], 142);
        tmp3 = _mm512_ternarylogic_epi32(rows[i], rows[i+1], rows[i+2], 39);
        rows[i]=tmp1;
        rows[i+1]=tmp2;
        rows[i+2]=tmp3;
    }

    int offset = (int)size/3;
    for(int i=0; i<offset; i+=1){
        __m512i tmp1, tmp2, tmp3;
        tmp1 = _mm512_ternarylogic_epi32(rows[i], rows[i+offset], rows[i+offset+offset], 106);
        tmp2 = _mm512_ternarylogic_epi32(rows[i], rows[i+offset], rows[i+offset+offset], 142);
        tmp3 = _mm512_ternarylogic_epi32(rows[i], rows[i+offset], rows[i+offset+offset], 39);
        rows[i]=tmp1;
        rows[i+1]=tmp2;
        rows[i+2]=tmp3;
    }

    __m512i A = _mm512_set1_epi64(
    // The 8x8 binary-matrix, defined as a 64-bit value (8x8=64)
    // This is the same as:
    //      [ 1 0 0 0 0 0 0 0 ] < Byte 7, Bit 0
    //      [ 0 1 0 0 0 0 0 0 ] < Byte 6, Bit 1
    //      [ 0 0 1 0 0 0 0 0 ] < Byte 5, Bit 2
    // X' = [ 0 0 0 1 0 0 0 0 ] < Byte 4, Bit 3  *  X + 0
    //      [ 0 0 0 0 1 0 0 0 ] < Byte 3, Bit 4
    //      [ 0 0 0 0 0 1 0 0 ] < Byte 2, Bit 5
    //      [ 0 0 0 0 0 0 1 0 ] < Byte 1, Bit 6
    //      [ 0 0 0 0 0 0 0 1 ] < Byte 0, Bit 7
    0b1000000001000000001000000001000000001000000001000000001000000001
   );

    for(int i=0; i<size; i++){
        rows[i]=_mm512_gf2p8affine_epi64_epi8(rows[i], A, 0);
    }
 
    for(int i=0; i<size; i++){
        rows[i]=_mm512_xor_epi64(rows[i], xor[i%54]);
    }

     char* base64_decoded = malloc((int)((size*6)/8));
     char* initial_base64_decoded = base64_decoded;

     for(int i=0; i<size; i++){
        __m512i tmp = lookup(rows[i]);
        tmp = _mm512_maddubs_epi16(tmp, _mm512_load_si512(magic_1));
        tmp = _mm512_madd_epi16(tmp, _mm512_load_si512(magic_2));
        const __m512i t1 = _mm512_shuffle_epi8(
            tmp,
            _mm512_set4lanes_epi8(
                2,  1,  0,
                6,  5,  4,
                10,  9,  8,
                14, 13, 12,
                -1, -1, -1, -1)
        );

        // shuffle bytes
        const __m512i s6 = _mm512_setr_epi32(
            0,  1,  2,
            4,  5,  6,
            8,  9, 10,
            12, 13, 14,
            // unused
            0,  0,  0, 0);

        const __m512i t2 = _mm512_permutexvar_epi32(s6, t1);
        _mm512_storeu_si512((__m512i*)(base64_decoded), t2);
        base64_decoded+=48;
     }

    

    int counter=0;
    if((int)((size*64*6)/8)!=2592){
        puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
        exit(-1);
    }
    for(int i=0; i<2592; i++){
        if((char)validator[i]!=(char)initial_base64_decoded[i]){
            puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
            exit(-1);
        }
    }
    puts("Thank you for your purchase! Now enjoy the fastest supercazzola in the room!");


}