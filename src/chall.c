
#include <immintrin.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>

#define build_dword(b0, b1, b2, b3)     \
     (((uint32_t)((uint8_t)(b0)) << 0*8)    \
    | ((uint32_t)((uint8_t)(b1)) << 1*8)    \
    | ((uint32_t)((uint8_t)(b2)) << 2*8)    \
    | ((uint32_t)((uint8_t)(b3)) << 3*8))

#define _mm512_set4lanes_epi8(b0, b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12, b13, b14, b15) \
    _mm512_setr4_epi32(                  \
        build_dword( b0,  b1,  b2,  b3), \
        build_dword( b4,  b5,  b6,  b7), \
        build_dword( b8,  b9, b10, b11), \
        build_dword(b12, b13, b14, b15))

const __u_char validator[]={11, 194, 212, 250, 170, 59, 207, 241, 119, 21, 61, 59, 225, 168, 68, 86, 69, 71, 47, 193, 68, 18, 37, 242, 131, 253, 199, 248, 255, 27, 23, 138, 22, 239, 177, 60, 30, 38, 210, 213, 36, 54, 158, 109, 121, 33, 96, 218, 171, 202, 48, 26, 249, 73, 41, 229, 239, 188, 145, 166, 91, 96, 21, 125, 238, 212, 120, 14, 169, 101, 227, 117, 79, 37, 87, 37, 52, 72, 240, 57, 149, 188, 209, 192, 245, 69, 8, 92, 171, 232, 20, 64, 206, 79, 4, 96, 146, 34, 124, 171, 228, 33, 184, 251, 158, 115, 69, 215, 114, 224, 93, 107, 58, 213, 237, 210, 235, 151, 239, 139, 85, 21, 210, 139, 205, 88, 35, 229, 76, 71, 181, 29, 189, 101, 232, 105, 66, 80, 0, 110, 125, 212, 82, 67, 60, 34, 152, 166, 100, 6, 84, 56, 17, 105, 41, 57, 170, 155, 253, 56, 125, 107, 187, 90, 190, 204, 128, 181, 235, 63, 228, 202, 25, 88, 250, 244, 67, 149, 224, 153, 243, 60, 153, 176, 41, 246, 139, 23, 216, 8, 164, 239, 145, 206, 232, 188, 133, 63, 70, 172, 140, 252, 156, 36, 19, 86, 19, 209, 191, 5, 177, 164, 189, 86, 36, 243, 38, 77, 43, 173, 249, 53, 93, 149, 96, 178, 236, 192, 224, 150, 54, 14, 170, 177, 218, 124, 25, 209, 0, 160, 210, 177, 166, 93, 24, 25, 55, 116, 251, 146, 61, 117, 185, 101, 170, 135, 207, 210, 49, 5, 130, 225, 175, 223, 114, 106, 224, 37, 207, 3, 126, 28, 18, 32, 211, 233, 196, 227, 102, 27, 44, 96, 103, 119, 53, 188, 48, 247, 60, 183, 208, 69, 31, 152, 110, 28, 141, 53, 223, 42, 203, 123, 7, 111, 151, 74, 26, 165, 168, 41, 56, 93, 235, 249, 105, 108, 38, 248, 49, 213, 106, 61, 106, 211, 206, 78, 27, 246, 165, 110, 103, 248, 191, 175, 146, 46, 95, 237, 69, 176, 110, 166, 12, 102, 38, 54, 83, 139, 223, 219, 95, 166, 164, 207, 44, 216, 208, 220, 118, 104, 34, 50, 213, 241, 191, 0, 158, 146, 178, 137, 86, 202, 124, 102, 143, 178, 63, 239, 136, 163, 63, 232, 159, 237, 138, 237, 204, 91, 110, 122, 169, 213, 125, 166, 91, 123, 139, 54, 241, 182, 39, 194, 201, 245, 251, 69, 245, 222, 50, 108, 178, 183, 128, 190, 19, 76, 184, 85, 235, 133, 244, 112, 219, 102, 246, 87, 238, 220, 224, 53, 121, 86, 176, 124, 223, 165, 114, 18, 154, 63, 172, 49, 192, 99, 65, 90, 86, 155, 219, 124, 111, 220, 96, 220, 80, 54, 84, 202, 112, 68, 88, 158, 42, 1, 148, 174, 155, 49, 86, 185, 122, 108, 153, 94, 228, 67, 112, 247, 165, 2, 46, 210, 118, 78, 163, 152, 12, 101, 86, 61, 211, 89, 204, 232, 214, 110, 70, 26, 69, 72, 183, 33, 93, 199, 147, 21, 40, 59, 140, 69, 202, 249, 146, 219, 79, 156, 119, 2, 44, 57, 20, 196, 207, 125, 248, 201, 214, 24, 176, 110, 196, 182, 223, 230, 38, 255, 161, 143, 21, 69, 64, 16, 39, 246, 196, 169, 187, 152, 82, 127, 49, 249, 202, 213, 124, 78, 83, 134, 98, 149, 17, 29, 239, 236, 66, 236, 135, 183, 94, 119, 34, 99, 164, 160, 45, 164, 119, 45, 78, 70, 129, 191, 35, 187, 217, 17, 172, 19, 36, 100, 1, 192, 95, 149, 208, 216, 241, 143, 91, 52, 132, 225, 87, 93, 188, 163, 122, 164, 18, 51, 93, 168, 210, 252, 35, 232, 85, 137, 86, 81, 84, 79, 160, 95, 64, 48, 242, 196, 177, 149, 30, 70, 41, 8, 94, 171, 90, 82, 23, 32, 202, 153, 198, 155, 9, 162, 9, 63, 184, 241, 226, 81, 111, 12, 90, 214, 24, 164, 76, 67, 242, 1, 28, 30, 250, 12, 40, 33, 14, 96, 237, 197, 111, 92, 175, 37, 0, 170, 125, 49, 132, 40, 53, 174, 249, 252, 146, 78, 43, 126, 227, 82, 7, 175, 161, 110, 15, 201, 47, 12, 216, 162, 163, 15, 146, 73, 40, 9, 226, 51, 204, 185, 238, 35, 123, 140, 233, 33, 148, 13, 8, 208, 114, 62, 20, 80, 223, 18, 34, 177, 42, 53, 117, 119, 240, 26, 74, 54, 249, 71, 49, 227, 155, 82, 243, 221, 117, 254, 6, 112, 240, 25, 2, 118, 18, 54, 60, 245, 85, 238, 136, 183, 4, 13, 198, 1, 183, 136, 173, 146, 208, 201, 155, 99, 140, 70, 41, 114, 228, 104, 247, 0, 40, 78, 203, 58, 230, 131, 32, 107, 57, 240, 198, 103, 249, 66, 212, 144, 118, 160, 70, 222, 134, 174, 72, 163, 118, 23, 239, 85, 46, 38, 46, 114, 236, 189, 152, 148, 33, 68, 7, 178, 159, 98, 172, 242, 1, 240, 157, 124, 226, 50, 231, 216, 199, 110, 73, 73, 217, 196, 50, 217, 142, 17, 131, 21, 178, 71, 213, 101, 224, 86, 224, 245, 202, 151, 108, 114, 30, 93, 148, 229, 74, 29, 159, 57, 210, 185, 148, 24, 193, 251, 42, 183, 46, 222, 171, 189, 167, 134, 107, 231, 130, 27, 100, 8, 59, 37, 77, 139, 192, 88, 136, 195, 133, 40, 240, 28, 249, 8, 95, 14, 168, 58, 185, 238, 176, 30, 219, 212, 27, 87, 170, 158, 244, 37, 143, 4, 44, 188, 94, 61, 112, 201, 180, 254, 46, 189, 33, 201, 132, 235, 207, 133, 237, 4, 67, 232, 145, 28, 159, 143, 33, 82, 146, 168, 213, 205, 26, 5, 142, 179, 54, 4, 84, 17, 8, 140, 126, 126, 132, 67, 235, 146, 201, 135, 154, 232, 84, 39, 156, 12, 99, 237, 2, 104, 47, 160, 105, 34, 38, 235, 103, 68, 187, 99, 142, 77, 139, 65, 205, 165, 185, 86, 107, 120, 112, 243, 229, 210, 28, 44, 76, 112, 202, 115, 101, 106, 180, 230, 179, 216, 218, 104, 238, 217, 41, 128, 1, 126, 210, 139, 120, 163, 3, 22, 137, 2, 53, 23, 151, 246, 245, 38, 84, 218, 237, 166, 78, 106, 137, 89, 96, 232, 240, 208, 54, 10, 206, 42, 71, 164, 130, 129, 244, 16, 8, 86, 93, 21, 232, 233, 8, 9, 198, 19, 171, 119, 123, 104, 192, 227, 15, 81, 192, 194, 216, 136, 210, 191, 188, 31, 224, 155, 167, 96, 40, 213, 187, 28, 142, 109, 243, 29, 156, 133, 111, 169, 252, 195, 202, 131, 108, 190, 124, 5, 203, 216, 62, 91, 48, 239, 31, 17, 204, 90, 94, 226, 20, 129, 72, 128, 172, 19, 112, 5, 8, 243, 25, 109, 143, 20, 243, 150, 211, 204, 10, 70, 149, 195, 251, 110, 180, 142, 121, 43, 114, 42, 61, 161, 126, 71, 172, 22, 79, 195, 220, 130, 179, 141, 234, 99, 199, 225, 185, 106, 30, 97, 88, 59, 82, 84, 144, 198, 120, 22, 136, 98, 114, 28, 102, 202, 65, 91, 76, 186, 252, 98, 146, 216, 62, 80, 82, 122, 87, 134, 184, 144, 169, 25, 125, 236, 91, 43, 71, 243, 107, 64, 177, 101, 162, 94, 132, 119, 43, 168, 129, 203, 69, 167, 118, 105, 254, 110, 61, 19, 122, 95, 203, 19, 35, 190, 221, 222, 126, 35, 102, 238, 243, 194, 182, 115, 224, 114, 35, 128, 96, 85, 200, 158, 11, 46, 4, 213, 158, 173, 168, 224, 151, 45, 229, 73, 87, 13, 188, 139, 21, 113, 14, 121, 124, 172, 69, 240, 134, 218, 175, 232, 108, 213, 67, 102, 12, 68, 123, 233, 171, 40, 79, 145, 50, 250, 213, 61, 30, 168, 2, 59, 50, 83, 103, 40, 185, 26, 169, 225, 161, 82, 210, 1, 70, 126, 72, 208, 7, 20, 113, 135, 244, 215, 23, 165, 53, 3, 231, 10, 34, 3, 12, 188, 242, 59, 84, 56, 114, 200, 218, 173, 254, 217, 59, 169, 121, 146, 204, 20, 130, 129, 14, 220, 79, 37, 126, 141, 181, 194, 136, 214, 178, 223, 82, 236, 110, 3, 60, 168, 128, 219, 250, 207, 78, 114, 126, 94, 71, 196, 157, 60, 210, 102, 100, 49, 52, 13, 253, 170, 234, 147, 94, 9, 184, 58, 147, 175, 64, 128, 170, 218, 118, 252, 108, 52, 190, 143, 127, 41, 241, 70, 31, 111, 39, 175, 236, 209, 214, 88, 16, 228, 108, 223, 10, 50, 72, 205, 141, 191, 107, 74, 109, 214, 225, 59, 50, 26, 86, 8, 107, 146, 189, 185, 230, 216, 165, 0, 228, 164, 104, 167, 162, 40, 54, 56, 202, 134, 17, 220, 245, 213, 211, 42, 22, 130, 30, 40, 250, 210, 20, 209, 200, 56, 174, 109, 178, 37, 69, 234, 212, 181, 240, 195, 36, 146, 220, 198, 43, 132, 230, 244, 177, 189, 178, 169, 179, 253, 4, 146, 210, 78, 209, 13, 127, 130, 110, 15, 218, 2, 65, 184, 122, 30, 126, 64, 241, 60, 145, 1, 241, 130, 97, 62, 33, 150, 94, 101, 153, 47, 168, 54, 230, 72, 182, 185, 34, 183, 30, 200, 118, 49, 172, 88, 66, 122, 20, 61, 18, 205, 72, 112, 186, 63, 94, 62, 73, 79, 125, 85, 117, 136, 79, 91, 146, 149, 170, 190, 226, 90, 212, 112, 89, 196, 193, 176, 69, 95, 214, 131, 62, 151, 232, 16, 153, 67, 69, 149, 149, 50, 123, 168, 240, 96, 121, 91, 64, 210, 44, 182, 134, 22, 12, 200, 201, 135, 22, 68, 193, 17, 20, 1, 131, 122, 108, 5, 186, 225, 10, 3, 41, 30, 29, 33, 165, 48, 126, 255, 21, 193, 37, 149, 247, 4, 85, 179, 180, 112, 192, 58, 41, 11, 169, 235, 167, 118, 28, 230, 251, 76, 249, 56, 108, 144, 238, 32, 104, 10, 173, 188, 48, 172, 49, 213, 221, 81, 196, 110, 107, 50, 167, 46, 231, 48, 93, 243, 190, 67, 154, 69, 11, 236, 46, 101, 233, 103, 171, 224, 57, 19, 199, 138, 173, 43, 84, 63, 67, 81, 238, 228, 122, 125, 249, 22, 131, 66, 138, 175, 63, 177, 138, 223, 89, 7, 17, 240, 177, 213, 46, 18, 112, 112, 235, 10, 154, 111, 79, 201, 206, 33, 208, 233, 252, 137, 128, 109, 247, 102, 176, 145, 31, 103, 53, 138, 107, 89, 252, 183, 94, 159, 82, 249, 45, 127, 146, 3, 36, 33, 245, 177, 83, 110, 39, 163, 128, 226, 243, 210, 37, 93, 233, 139, 171, 238, 30, 221, 24, 27, 164, 184, 149, 113, 8, 204, 55, 143, 26, 44, 20, 111, 124, 17, 250, 36, 179, 254, 80, 103, 68, 253, 251, 212, 231, 63, 17, 124, 91, 70, 153, 146, 66, 151, 176, 55, 41, 0, 34, 171, 140, 53, 85, 221, 101, 111, 88, 105, 27, 147, 30, 64, 67, 67, 65, 145, 229, 91, 75, 132, 10, 67, 55, 85, 88, 67, 146, 104, 187, 232, 37, 46, 132, 218, 162, 242, 145, 230, 83, 185, 38, 6, 147, 157, 108, 122, 29, 179, 24, 40, 118, 180, 80, 160, 93, 143, 10, 4, 159, 244, 99, 129, 84, 122, 161, 35, 141, 136, 70, 108, 216, 62, 11, 63, 192, 123, 112, 79, 126, 160, 251, 255, 39, 124, 237, 116, 244, 142, 67, 185, 204, 238, 176, 60, 236, 191, 30, 1, 249, 58, 186, 214, 212, 209, 255, 218, 169, 192, 191, 127, 164, 34, 15, 16, 106, 90, 73, 202, 115, 120, 93, 251, 34, 80, 33, 255, 138, 81, 106, 142, 132, 255, 3, 36, 245, 72, 26, 232, 225, 51, 214, 208, 104, 156, 91, 39, 155, 216, 77, 65, 108, 252, 190, 113, 96, 26, 98, 108, 170, 24, 75, 142, 112, 68, 28, 24, 196, 99, 3, 179, 201, 243, 104, 213, 104, 204, 161, 23, 83, 210, 10, 2, 145, 192, 207, 183, 227, 106, 182, 50, 86, 60, 117, 207, 45, 73, 84, 224, 204, 20, 233, 143, 57, 196, 115, 47, 72, 165, 42, 65, 93, 43, 148, 152, 108, 152, 51, 239, 167, 44, 216, 136, 119, 92, 20, 198, 166, 10, 181, 7, 143, 245, 198, 146, 101, 133, 209, 211, 111, 191, 153, 182, 154, 173, 232, 133, 128, 109, 149, 155, 112, 214, 148, 98, 81, 147, 101, 200, 40, 101, 249, 156, 9, 69, 69, 176, 96, 206, 31, 80, 3, 200, 109, 219, 70, 70, 208, 68, 136, 205, 42, 245, 166, 109, 108, 171, 252, 249, 245, 18, 236, 208, 211, 93, 25, 103, 102, 204, 228, 26, 164, 50, 188, 183, 90, 118, 13, 148, 94, 254, 40, 116, 188, 222, 236, 153, 59, 82, 151, 42, 208, 182, 76, 191, 170, 53, 31, 3, 33, 96, 2, 155, 108, 206, 137, 12, 208, 88, 229, 99, 89, 142, 110, 245, 95, 12, 252, 24, 24, 62, 152, 233, 24, 234, 210, 161, 86, 140, 111, 114, 139, 70, 126, 213, 239, 112, 215, 17, 233, 89, 204, 254, 166, 125, 47, 176, 79, 199, 239, 150, 159, 140, 48, 63, 17, 157, 5, 169, 61, 242, 79, 2, 158, 51, 225, 157, 189, 107, 210, 122, 171, 165, 248, 119, 172, 5, 107, 170, 6, 75, 27, 207, 237, 11, 158, 246, 208, 24, 227, 186, 8, 210, 214, 243, 38, 96, 156, 129, 148, 39, 149, 146, 86, 208, 67, 118, 145, 0, 67, 223, 43, 39, 14, 110, 163, 82, 155, 43, 69, 141, 169, 220, 37, 94, 81, 192, 44, 56, 101, 113, 220, 124, 159, 69, 153, 23, 18, 112, 97, 170, 144, 2, 51, 131, 213, 109, 117, 187, 37, 124, 213, 16, 48, 120, 2, 66, 141, 120, 43, 96, 107, 96, 51, 131, 196, 240, 135, 229, 7, 243, 224, 181, 220, 39, 130, 81, 154, 150, 101, 152, 133, 185, 21, 56, 6, 176, 34, 247, 125, 146, 60, 203, 164, 172, 54, 223, 231, 40, 28, 19, 112, 108, 38, 135, 204, 138, 239, 187, 72, 12, 254, 119, 200, 237, 178, 24, 203, 166, 196, 203, 238, 94, 115, 113, 187, 4, 17, 209, 35, 117, 14, 242, 247, 120, 135, 42, 103, 212, 92, 229, 229, 212, 217, 10, 122, 232, 68, 125, 225, 193, 172, 32, 166, 5, 222, 112, 5, 174, 60, 52, 107, 55, 122, 67, 147, 106, 1, 21, 133, 66, 208, 16, 127, 116, 38, 77, 255, 221, 2, 169, 125, 240, 229, 108, 125, 157, 151, 97, 174, 147, 156, 14, 188, 115, 169, 27, 174, 229, 188, 234, 57, 88, 131, 206, 174, 195, 82, 178, 196, 184, 5, 223, 242, 225, 36, 97, 209, 80, 251, 190, 38, 250, 177, 209, 212, 145, 184, 180, 116, 208, 183, 10, 196, 114, 228, 101, 140, 178, 88, 127, 22, 170, 174, 154, 124, 223, 20, 208, 53, 107, 42, 211, 82, 254, 12, 163, 66, 171, 179, 173, 14, 151, 128, 174, 164, 14, 120, 61, 72, 237, 76, 141, 230, 161, 41, 15, 126, 107, 174, 16, 155, 229, 124, 70, 2, 220, 107, 166, 153, 77, 17, 187, 184, 62, 183, 125, 208, 109, 141, 81, 103, 148, 67, 78, 252, 79, 221, 59, 213, 133, 208, 131, 55, 153, 85, 162, 210, 102, 14, 82, 248, 228, 218, 135, 2, 46, 50, 129, 161, 53, 12, 59, 66, 244, 211, 147, 115, 100, 38, 242, 34, 193, 90, 234, 80, 64, 166, 46};
const unsigned char magic_3[] = {168,4,134,94,202,222,242,76,243,18,85,229,127,154,107,80,181,52,218,155,80,101,66,217,120,90,100,177,98,145,140,139,104,252,216,251,253,17,212,172,73,48,183,247,213,165,123,107,85,122,218,97,100,236,35,149,56,110,28,215,171,125,205,57,57,138,97,238,204,147,39,230,219,245,118,124,170,76,176,159,147,80,176,94,1,65,144,85,207,231,149,236,197,13,220,81,177,164,90,27,40,91,169,105,177,7,102,45,204,145,63,38,235,168,136,107,93,134,22,123,177,178,223,18,156,175,137,192,29,194,187,38,94,243,120,223,152,28,9,221,168,166,47,113,177,181,25,118,166,19,62,74,128,43,103,230,189,191,135,172,170,218,108,227,105,50,197,191,201,209,123,160,19,107,56,6,139,191,18,154,96,96,186,87,153,50,223,15,63,75,191,253,211,140,8,18,249,25,228,181,197,90,160,121,75,154,242,110,192,31,41,203,12,213,32,183,69,115,44,189,4,69,139,211,3,219,48,118,190,182,237,244,199,76,110,20,218,101,100,76,21,153,212,43,95,169,54,80,29,213,62,188,118,49,248,39,127,202,53,48,68,46,242,30,162,104,136,183,128,238,23,109,206,205,69,8,144,210,53,194,205,6,206,10,29,209,123,16,226,16,139,190,114,170,193,52,105,124,242,79,29,215,221,212,173,131,207,244,14,244,176,110,33,162,17,61,136,228,235,4,106,181,74,211,71,36,59,226,82,182,45,4,126,56,61,232,101,16,57,116,5,2,157,250,7,101,55,220,150,135,165,227,215,146,36,19,49,59,104,237,254,181,172,16,8,127,72,249,120,180,25,79,54,207,226,223,141,106,194,69,247,130,189,121,193,167,111,102,206,15,216,36,55,162,112,118,184,148,107,27,26,254,249,129,29,41,249,234,166,114,3,143,149,83,148,90,174,84,205,217,103,196,233,157,31,227,25,65,225,211,88,24,181,36,192,135,85,54,187,233,242,176,32,228,157,209,22,142,247,89,143,9,170,175,70,61,249,226,114,232,229,129,143,0,199,133,19,164,175,51,157,196,230,79,178,159,92,124,70,207,27,104,58,104,167,85,91,4,30,197,126,132,198,76,108,28,204,15,6,131,8,144,216,180,17,194,39,79,28,119,125,35,114,97,107,12,57,232,175,13,164,203,61,250,4,166,228,191,210,239,238,64,55,43,72,74,63,207,191,171,197,97,37,156,71,139,181,102,254,185,195,236,206,18,232,95,111,248,29,222,115,178,212,116,49,147,139,165,153,207,148,243,160,146,38,188,233,100,125,172,55,1,248,140,242,235,139,4,237,170,205,255,133,27,118,215,205,57,184,111,149,103,2,70,209,122,100,232,12,66,13,123,102,166,84,13,16,108,43,207,54,97,169,31,221,254,105,66,17,84,76,44,142,22,151,209,220,56,91,48,59,80,36,157,248,191,160,103,65,131,91,64,11,71,79,27,63,24,146,44,225,213,54,151,25,160,214,29,247,63,123,67,137,159,192,216,69,197,222,215,166,125,164,27,226,241,203,246,19,253,36,248,89,145,191,5,153,54,109,30,22,162,8,115,22,237,245,63,244,129,252,228,7,180,236,245,92,100,156,222,127,59,214,57,197,61,215,117,102,165,46,197,206,16,54,150,54,224,207,20,130,191,63,17,255,115,251,36,180,216,40,238,78,179,98,213,218,56,176,60,198,111,147,246,246,127,30,140,25,55,168,241,86,249,211,225,241,253,54,248,186,7,70,31,229,101,19,167,88,23,163,219,196,106,36,77,59,204,106,28,132,36,28,156,201,117,84,113,219,239,5,162,12,14,158,55,253,54,197,107,231,214,12,26,59,139,17,21,84,16,221,254,20,99,160,45,213,159,52,125,190,157,26,107,239,255,232,253,146,243,173,243,249,234,142,115,230,156,238,235,57,136,52,252,4,219,141,244,167,202,113,28,55,239,65,109,240,6,123,59,182,117,42,36,210,182,5,220,114,161,233,69,103,34,211,214,230,95,142,78,123,202,55,115,147,22,208,76,13,93,43,190,249,88,89,213,153,178,246,238,52,157,77,44,45,109,47,104,219,98,92,127,207,208,127,151,61,71,58,231,72,23,187,240,71,214,110,97,64,26,46,181,116,213,11,232,41,145,170,176,132,63,167,239,45,172,152,96,130,41,95,44,102,134,146,33,165,188,65,242,217,209,111,239,34,125,19,210,236,14,62,61,114,206,164,57,102,227,82,8,163,59,187,129,68,41,6,138,68,201,184,66,148,50,11,25,202,125,126,41,72,238,165,219,165,17,183,249,62,249,13,196,79,178,213,3,127,103,152,9,13,47,130,85,111,73,222,93,76,72,36,55,232,148,43,164,172,200,108,230,187,28,33,246,215,201,22,2,126,30,97,184,107,252,2,201,219,139,48,54,185,250,228,238,70,219,200,207,124,143,225,143,77,81,175,108,11,11,20,140,135,83,123,112,43,11,253,132,127,192,198,101,173,131,101,238,99,255,167,138,143,112,164,109,50,80,103,110,158,214,20,211,19,89,96,39,162,201,95,70,196,74,40,89,13,55,235,230,17,237,102,172,106,212,216,76,183,124,73,156,81,156,229,142,155,152,114,96,123,132,227,79,168,206,199,131,241,217,249,140,166,240,25,225,93,191,214,143,113,62,255,160,235,6,156,195,130,145,115,140,160,33,97,157,25,104,214,232,160,1,161,161,142,204,56,208,181,79,140,108,44,124,5,149,214,240,22,118,81,138,160,27,155,108,48,129,178,198,171,221,67,26,182,128,211,200,209,100,71,9,98,70,109,104,10,118,76,125,67,75,42,233,169,23,110,196,174,123,18,108,213,196,194,70,252,200,158,128,149,43,233,49,30,93,244,50,8,29,86,90,183,18,122,248,27,130,104,230,28,226,211,185,183,119,49,227,51,252,155,204,215,247,252,8,145,114,17,207,143,162,52,89,155,161,186,115,110,126,100,6,189,207,78,227,250,76,198,23,68,45,122,180,227,14,78,222,203,203,128,240,189,35,187,23,58,169,225,102,208,12,155,89,54,161,114,163,6,181,174,210,182,123,86,128,97,70,64,193,255,116,41,11,82,172,189,10,236,201,250,108,253,169,165,147,200,39,67,128,218,228,123,125,106,199,69,131,17,127,189,238,221,21,46,172,109,148,94,2,113,68,104,93,163,133,46,189,155,193,167,56,255,201,113,15,0,241,243,67,149,113,89,185,250,163,82,182,94,9,103,25,95,80,117,154,199,228,23,249,86,51,241,9,193,93,134,43,240,39,133,94,141,195,233,200,181,104,148,189,239,40,141,137,254,228,159,69,242,170,168,36,105,179,221,162,85,4,253,72,47,238,11,3,200,32,155,128,40,197,246,112,41,11,254,129,15,52,153,27,129,76,219,130,45,72,47,130,157,144,124,82,99,19,46,90,128,243,108,57,183,92,74,30,216,87,164,110,44,4,233,178,8,248,142,85,19,53,188,148,4,7,193,237,126,180,245,3,9,58,70,1,19,53,35,225,159,139,177,97,182,39,23,245,9,241,199,161,181,109,26,201,244,41,252,226,156,92,140,150,199,89,38,189,27,63,247,38,83,172,250,131,163,171,212,173,121,218,197,240,178,217,213,162,41,214,231,150,166,136,50,88,184,90,110,171,216,216,92,167,88,201,47,84,240,83,160,77,242,173,253,187,15,105,231,132,97,3,21,46,120,196,208,43,95,158,9,249,128,248,94,8,60,230,10,103,32,2,28,98,191,77,80,16,178,91,162,249,10,112,65,203,3,107,211,93,87,48,141,49,48,56,61,137,239,160,62,44,40,50,73,223,38,48,64,244,233,186,172,156,78,81,141,249,48,109,159,135,1,10,83,170,87,234,151,108,239,65,97,58,26,172,49,208,126,86,68,220,1,126,6,76,113,1,22,244,169,93,143,217,8,97,15,156,212,97,48,110,119,213,159,110,173,68,210,69,12,106,76,43,56,146,77,250,154,18,167,39,89,227,107,71,154,108,128,32,211,105,103,239,26,9,73,73,63,236,110,122,81,175,5,68,221,116,30,231,13,25,60,106,24,135,33,99,203,218,156,27,77,110,142,228,125,121,101,198,100,173,3,233,59,182,84,110,166,29,109,71,97,95,25,174,25,122,160,49,201,35,209,166,88,0,191,65,101,101,109,99,161,35,106,4,39,196,54,176,212,220,209,126,52,20,19,172,177,207,227,124,45,252,228,169,163,222,28,255,153,248,39,192,108,9,237,32,84,174,109,57,206,29,193,213,250,38,225,219,12,158,3,9,236,249,231,248,85,168,131,117,76,141,244,130,130,142,249,88,9,26,211,83,108,219,91,38,149,199,197,87,238,38,93,61,155,194,65,158,133,87,214,160,122,176,232,253,203,109,155,56,215,115,189,127,148,78,23,150,152,171,72,107,76,133,143,90,196,196,255,80,177,106,121,180,29,235,83,110,167,147,84,12,14,115,30,22,73,143,116,43,103,61,77,60,50,128,57,4,240,233,219,122,41,79,190,169,127,219,29,182,34,195,46,255,72,101,89,4,94,154,161,125,57,174,89,0,126,119,53,255,185,124,3,209,172,239,43,70,16,3,126,150,151,62,184,151,95,3,55,27,242,139,184,204,191,108,198,85,213,202,252,229,73,107,29,108,156,28,16,64,99,6,194,113,211,136,16,165,251,36,163,215,123,4,48,225,154,180,202,83,209,189,172,133,75,158,10,56,66,83,153,174,20,127,235,137,126,90,138,139,107,227,177,234,166,253,67,207,25,87,176,36,98,31,10,120,141,194,45,197,145,228,230,74,165,142,48,246,63,122,212,57,231,28,209,36,252,218,218,229,126,198,25,50,150,211,142,32,163,252,23,110,234,218,42,242,178,87,82,142,103,103,180,17,63,62,43,99,108,84,137,83,94,215,153,193,1,210,205,181,208,105,70,247,78,232,56,125,101,245,87,144,163,51,54,158,184,74,241,133,95,16,13,233,106,244,162,167,34,89,192,27,158,131,149,211,177,136,99,53,213,207,106,88,25,143,163,202,69,135,100,118,194,98,95,213,0,5,228,205,0,23,15,156,142,215,198,41,2,118,198,246,127,163,215,62,30,250,4,75,44,252,183,111,237,99,64,71,145,56,82,25,232,195,80,71,162,34,143,210,201,199,51,140,9,133,41,231,120,146,74,119,153,230,127,145,154,209,42,43,150,7,30,246,115,153,23,206,14,145,133,161,57,236,133,8,144,80,188,170,183,115,34,28,116,51,79,36,128,92,225,55,93,0,39,138,125,76,70,161,100,163,179,96,176,87,80,32,204,201,65,61,87,184,182,121,54,198,68,243,221,247,104,83,154,153,174,158,34,217,237,41,231,7,236,48,125,82,123,205,68,45,199,152,69,175,16,198,152,24,152,91,185,103,161,248,58,208,241,153,175,33,86,41,243,181,210,162,243,130,60,28,237,20,106,95,218,222,125,233,15,250,15,114,120,228,234,94,58,43,106,54,128,192,3,130,35,144,115,218,142,186,229,251,19,190,234,68,14,76,52,121,156,18,81,197,46,171,213,172,180,163,32,11,74,250,207,74,185,37,131,237,249,145,196,70,96,208,136,231,181,1,141,145,50,102,175,185,49,214,49,175,52,39,238,177,59,50,81,148,99,35,26,152,55,143,76,163,208,234,54,146,78,127,171,216,149,183,232,200,206,79,111,226,225,85,83,68,183,88,94,15,155,60,23,62,128,72,166,241,82,17,14,77,221,233,229,109,22,117,73,100,180,210,209,29,198,122,187,53,55,45,24,44,9,117,36,75,230,185,185,54,196,118,155,41,94,65,242,242,183,209,224,236,15,201,137,138,166,61,37,167,247,43,51,0,94,185,19,219,119,174,193,89,79,184,224,19,140,68,28,51,121,47,213,153,87,157,211,216,35,72,74,20,234,162,252,152,46,200,78,148,209,186,238,63,61,48,40,28,51,158,236,64,13,131,33,211,143,221,83,37,87,98,203,244,206,203,101,84,110,45,175,34,48,134,119,210,75,48,23,65,172,59,144,151,36,172,23,168,125,191,150,55,78,109,232,141,105,159,132,194,26,188,156,192,39,184,228,212,253,17,173,119,120,245,114,61,12,61,173,163,165,236,49,157,169,122,187,123,144,170,105,143,39,71,63,13,38,85,135,78,205,191,146,104,17,158,203,241,249,118,168,208,58,81,54,128,81,155,139,61,222,155,15,228,32,17,87,206,78,127,126,136,108,19,135,115,48,225,221,145,9,113,165,191,196,173,77,213,255,242,5,160,123,20,27,90,20,216,61,79,226,215,132,44,38,67,215,223,127,172,197,155,159,49,160,138,72,65,202,56,116,42,146,23,72,124,241,145,113,111,208,143,81,245,97,99,121,99,38,139,158,52,170,51,196,91,244,86,221,237,72,171,46,182,170,153,169,11,76,180,94,236,31,191,99,177,78,157,150,81,173,82,115,224,254,227,32,85,151,54,73,204,77,16,247,102,221,195,245,235,93,146,31,158,66,215,215,248,189,86,204,226,139,159,134,147,59,191,154,130,213,235,187,154,245,117,41,25,122,122,15,196,196,59,13,240,233,78,89,176,225,193,106,227,225,199,38,198,59,110,35,178,206,207,56,180,212,233,241,254,66,152,203,135,239,119,12,250,63,208,142,238,21,76,74,92,35,236,62,226,192,187,194,182,9,226,239,49,143,227,198,29,209,248,200,101,201,192,167,98,139,82,240,179,146,119,96,39,107,50,6,45,28,202,117,227,30,56,45,156,46,87,214,72,40,252,195,127,228,151,148,122,129,186,63,38,94,239,41,21,73,15,194,80,139,60,191,65,81,229,147,221,115,148,73,12,165,196,195,169,252,4,200,238,30,175,60,224,188,221,47,54,203,108,124,117,186,142,226,95,218,198,62,138,88,9,144,85,178,210,167,200,195,182,200,214,224,151,138,190,221,203,193,70,38,74,79,22,222,143,204,20,132,198,141,9,28,106,178,55,243,173,12,92,126,70,107,243,5,17,56,74,253,196,134,52,192,237,78,146,72,237,37,3,194,126,13,117,93,185,49,57,13,35,53,5,74,68,78,151,181,224,59,129,191,185,225,243,139,254,172,64,166,129,11,218,113,13,195,255,221,148,83,183,116,238,221,253,252,62,163,74,193,218,233,217,232,143,119,32,201,99,113,115,138,36,47,246,195,137,37,41,173,137,39,234,133,16,25,89,127,134,117,111,61,21,196,50,131,94,214,126,167,208,28,203,242,100,33,97,173,146,58,101,12,51,174,251,115,46,212,193,136,69,30,77,87,63,41,247,165,195,63,204,122,71,65,184,35,6,202,92,109,100,177,191,40,158,126,92,81,134,168,154,21,31,84,138,41,253,152,185,1,58,115,186,216,66,58,246,219,237,124,178,112,175,38,49,54,113,174,23,85,58,178,1,109,172,236,140,231,70,99,100,92,5,160,75,240,179,77,180,159,15,238,159,201,227,49,180,142,204,252,141,242,173,198,165,95,21,218,37,169,68,74,251,184,42,207,128,198,158,5,183,2,176,195,112,184,85,92,22,237,211,16,41,14,102,71,110,173,10,159,126,21,138,158,28,171,239,150,81,137,209,115,114,213,157,131,101,233,159,174,190,39,29,203,4,225,134,196,106,56,198,149,1,0,70,145,15,49,239,84,226,73,29,194,176,235,177,14,170,215,27,163,38,106,94,178,251,30,232,112,67,195,251,248,54};
const uint32_t magic_1[] = {0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140,0x01400140};
const uint32_t magic_2[] = {0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000,0x00011000};
const unsigned char values[]={0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,62,0x80,0x80,0x80,63,52,53,54,55,56,57,58,59,60,61,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0x80,0x80,0x80,0x80,0x80,0x80,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,0x80,0x80,0x80,0x80,0x80};
__m512i lookup_0;
__m512i lookup_1;

__m512i xor[54];

void f1(__m128i *m1, __m128i *m2, __m128i *res){
    __m128i r, c, x;
    __m128i ret[4];

    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 0);
    
    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 1);
    
    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 2);
    
    r = m1[0];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[0] = _mm_insert_epi32(ret[0], _mm_extract_epi32(x, 3), 3);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 0);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 1);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 2);
    
    r = m1[1];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);

    x = _mm_hadd_epi32(x, x);
    ret[1] = _mm_insert_epi32(ret[1], _mm_extract_epi32(x, 3), 3);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 0);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 1);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 2);
    
    r = m1[2];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[2] = _mm_insert_epi32(ret[2], _mm_extract_epi32(x, 3), 3);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 0), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 0), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 0), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 0), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 0);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 1), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 1), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 1), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 1), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 1);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 2), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 2), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 2), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 2), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);
    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 2);
    
    r = m1[3];
    c = _mm_setzero_si128();
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[0], 3), 0);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[1], 3), 1);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[2], 3), 2);
    c = _mm_insert_epi32(c, _mm_extract_epi32(m2[3], 3), 3);
    x = _mm_mullo_epi32(r, c);
    x = _mm_hadd_epi32(x, x);
    x = _mm_hadd_epi32(x, x);

    ret[3] = _mm_insert_epi32(ret[3], _mm_extract_epi32(x, 3), 3);
    res[0] = ret[0];
    res[1] = ret[1];
    res[2] = ret[2];
    res[3] = ret[3];
}

void f0(__m128i *mat, uint32_t exp, __m128i *res){
    int exp_i = 31;
    uint32_t _ret[16] = {1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1};
    __m128i ret[4] = {_mm_load_epi32(_ret+0x0), _mm_load_epi32(_ret+0x4), _mm_load_epi32(_ret+0x8), _mm_load_epi32(_ret+0xc)};

    while(exp_i >= 0){
        if(exp & (1 << exp_i)){
            f1(ret, ret, ret);
            f1(ret, mat, ret);
        }
        else{
            f1(ret, ret, ret);
        }
        exp_i--;
    }
    for(int i=0; i<4; i++){
        res[i] = ret[i];
    }
}

void setup(){
    lookup_0 = _mm512_loadu_epi8(values);
    lookup_1 = _mm512_loadu_epi8(values+64);
    for(int i=0; i<54; i++){
        xor[i]=_mm512_load_si512(magic_3+i*64);
    }
}

__m512i lookup(const __m512i input) {

    const __m512i translated = _mm512_permutex2var_epi8(lookup_0, input, lookup_1);

    const uint64_t mask = _mm512_movepi8_mask(translated | input); // convert MSBs to the mask
    if (mask) {
        puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
        exit(-1);
    }

    return translated;
}

int main(){
    setup();
    char input[512]={0};
    printf("Please input your product key: ");
    fgets(input, 512, stdin);
    if(input[strlen(input)-1]=='\n'){
        input[strlen(input)-1]='\0';
    }
    if(strncmp(input, "ptm{", 4)!=0 || input[strlen(input)-1]!='}' || (strlen(input)-5)%2!=0 || (int)((strlen(input)-5)/2)%3!=0){
        puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
        exit(-1);
    }

    size_t size = (int)((strlen(input)-5)/2);
    __m512i *rows = malloc(sizeof(__m512i)*size);

    uint32_t data[4] = {3082479570,  404556667, 2593462557, 1619391743};
    uint32_t data2[4] = {3896563185,  551914195, 3138858061, 1932880005};
    uint32_t data3[4] = {3152929916, 2405058092,  231066320,  887409827};
    uint32_t data4[4] = {2950501807,  580593730,  420528199, 2240878451};
    __m128i matrix[4] = {_mm_load_epi32(data), _mm_load_epi32(data2), _mm_load_epi32(data3), _mm_load_epi32(data4)};

    for(int counter=4; counter<(strlen(input)-1); counter+=2){ //FastExp step
        uint32_t exponent = input[counter+1];
        exponent = (exponent<<8)+input[counter];
        __m128i output[4];
        f0(matrix, exponent, output);
        __m512i output512 = _mm512_castsi128_si512(output[0]);
        output512 = _mm512_inserti32x4(output512, output[1], 1);
        output512 = _mm512_inserti32x4(output512, output[2], 2);
        output512 = _mm512_inserti32x4(output512, output[3], 3);
        rows[(int)((counter-4)/2)]=output512;
    }

    for(int i=0; i<size;i+=3){ //Ternary logic step
        __m512i tmp1, tmp2, tmp3;
        tmp1 = _mm512_ternarylogic_epi32(rows[i], rows[i+1], rows[i+2], 106);
        tmp2 = _mm512_ternarylogic_epi32(rows[i], rows[i+1], rows[i+2], 142);
        tmp3 = _mm512_ternarylogic_epi32(rows[i], rows[i+1], rows[i+2], 39);
        rows[i]=tmp1;
        rows[i+1]=tmp2;
        rows[i+2]=tmp3;
    }

    int offset = (int)size/3;
    for(int i=0; i<offset; i+=1){
        __m512i tmp1, tmp2, tmp3;
        tmp1 = _mm512_ternarylogic_epi32(rows[i], rows[i+offset], rows[i+offset+offset], 106);
        tmp2 = _mm512_ternarylogic_epi32(rows[i], rows[i+offset], rows[i+offset+offset], 142);
        tmp3 = _mm512_ternarylogic_epi32(rows[i], rows[i+offset], rows[i+offset+offset], 39);
        rows[i]=tmp1;
        rows[i+offset]=tmp2;
        rows[i+offset+offset]=tmp3;
    }

    __m512i A = _mm512_set1_epi64(
    // The 8x8 binary-matrix, defined as a 64-bit value (8x8=64)
    // This is the same as:
    //      [ 1 0 0 0 0 0 0 0 ] < Byte 7, Bit 0
    //      [ 0 1 0 0 0 0 0 0 ] < Byte 6, Bit 1
    //      [ 0 0 1 0 0 0 0 0 ] < Byte 5, Bit 2
    // X' = [ 0 0 0 1 0 0 0 0 ] < Byte 4, Bit 3  *  X + 0
    //      [ 0 0 0 0 1 0 0 0 ] < Byte 3, Bit 4
    //      [ 0 0 0 0 0 1 0 0 ] < Byte 2, Bit 5
    //      [ 0 0 0 0 0 0 1 0 ] < Byte 1, Bit 6
    //      [ 0 0 0 0 0 0 0 1 ] < Byte 0, Bit 7
    0b1000000001000000001000000001000000001000000001000000001000000001
   );

    for(int i=0; i<size; i++){
        rows[i]=_mm512_gf2p8affine_epi64_epi8(rows[i], A, 0);
    }
 
    for(int i=0; i<size; i++){
        rows[i]=_mm512_xor_epi64(rows[i], xor[i%54]);
    }

     char* base64_decoded = malloc((int)((size*6)/8));
     char* initial_base64_decoded = base64_decoded;

     for(int i=0; i<size; i++){
        __m512i tmp = lookup(rows[i]);
        tmp = _mm512_maddubs_epi16(tmp, _mm512_load_si512(magic_1));
        tmp = _mm512_madd_epi16(tmp, _mm512_load_si512(magic_2));
        const __m512i t1 = _mm512_shuffle_epi8(
            tmp,
            _mm512_set4lanes_epi8(
                2,  1,  0,
                6,  5,  4,
                10,  9,  8,
                14, 13, 12,
                -1, -1, -1, -1)
        );

        // shuffle bytes
        const __m512i s6 = _mm512_setr_epi32(
            0,  1,  2,
            4,  5,  6,
            8,  9, 10,
            12, 13, 14,
            // unused
            0,  0,  0, 0);

        const __m512i t2 = _mm512_permutexvar_epi32(s6, t1);
        _mm512_storeu_si512((__m512i*)(base64_decoded), t2);
        base64_decoded+=48;
     }

    

    int counter=0;
    if((int)((size*64*6)/8)!=2592){
        puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
        exit(-1);
    }
    for(int i=0; i<2592; i++){
        if((char)validator[i]!=(char)initial_base64_decoded[i]){
            puts("Wrong product key, please send an email to mister96@m0lecon.xato for purchase options.");
            exit(-1);
        }
    }
    puts("Thank you for your purchase! Now enjoy the fastest supercazzola in the room!");


}